SELECT apellido1, apellido2, nombre FROM universidad.persona WHERE tipo = 'alumno' ORDER BY apellido1, apellido2, nombre;
SELECT nombre, apellido1, apellido2 FROM universidad.persona WHERE tipo = 'alumno' AND ISNULL(telefono) ORDER BY apellido1, apellido2, nombre;
SELECT nombre, apellido1, apellido2 FROM universidad.persona WHERE tipo = 'alumno' AND YEAR(fecha_nacimiento) = '1999' ORDER BY apellido1, apellido2, nombre;
SELECT nombre, apellido1, apellido2 FROM universidad.persona WHERE tipo = 'profesor' AND ISNULL(telefono) ORDER BY apellido1, apellido2, nombre;
SELECT asignatura.nombre FROM universidad.asignatura WHERE cuatrimestre = '1' AND curso = '3' AND  id_grado = '7';
SELECT persona.apellido1, persona.apellido2, persona.nombre, departamento.nombre AS 'nombre_departamento' FROM universidad.persona INNER JOIN universidad.profesor ON universidad.persona.id = universidad.profesor.id_profesor INNER JOIN universidad.departamento ON universidad.profesor.id_departamento = universidad.departamento.id WHERE persona.tipo = 'profesor' ORDER BY apellido1, apellido2, nombre;
SELECT asignatura.nombre, curso_escolar.anyo_inicio, curso_escolar.anyo_fin FROM universidad.asignatura INNER JOIN universidad.alumno_se_matricula_asignatura ON universidad.asignatura.id = universidad.alumno_se_matricula_asignatura.id_asignatura INNER JOIN universidad.curso_escolar ON universidad.alumno_se_matricula_asignatura.id_curso_escolar = universidad.curso_escolar.id INNER JOIN universidad.persona ON universidad.persona.id = universidad.alumno_se_matricula_asignatura.id_alumno WHERE persona.nif = '26902806M';
SELECT DISTINCT departamento.nombre FROM departamento INNER JOIN profesor ON departamento.id = profesor.id_departamento INNER JOIN asignatura ON profesor.id_profesor = asignatura.id_profesor INNER JOIN grado ON asignatura.id_grado = grado.id WHERE grado.nombre = 'Grado en Ingeniería Informática (Plan 2015)' ;
SELECT DISTINCT persona.nombre, persona.apellido1, persona.apellido2 FROM persona INNER JOIN alumno_se_matricula_asignatura ON persona.id = alumno_se_matricula_asignatura.id_alumno INNER JOIN curso_escolar ON curso_escolar.id = alumno_se_matricula_asignatura.id_curso_escolar WHERE curso_escolar.anyo_inicio = '2018' and curso_escolar.anyo_fin = '2019';
SELECT DISTINCT departamento.nombre as 'nombre_departamento', persona.apellido1, persona.apellido2, persona.nombre FROM persona LEFT JOIN profesor ON persona.id = profesor.id_profesor LEFT JOIN departamento ON profesor.id_departamento = departamento.id WHERE persona.tipo = 'profesor' ORDER BY departamento.nombre, persona.apellido1, persona.apellido2, persona.nombre;
SELECT DISTINCT persona.apellido1, persona.apellido2, persona.nombre FROM persona LEFT JOIN profesor ON persona.id = profesor.id_profesor LEFT JOIN departamento ON profesor.id_departamento = departamento.id WHERE persona.tipo = 'profesor' AND departamento.id is null ORDER BY persona.apellido1, persona.apellido2, persona.nombre;
SELECT DISTINCT departamento.nombre as 'nombre_departamento' FROM departamento LEFT JOIN profesor ON departamento.id = profesor.id_departamento LEFT JOIN persona ON persona.id = profesor.id_profesor WHERE persona.nombre IS NULL;
SELECT DISTINCT persona.nombre, persona.apellido1, persona.apellido2, persona.tipo FROM persona LEFT JOIN profesor ON persona.id = profesor.id_profesor LEFT JOIN asignatura ON profesor.id_profesor = asignatura.id_profesor WHERE persona.tipo ='profesor' AND asignatura.id_profesor IS NULL;
SELECT DISTINCT asignatura.nombre FROM asignatura WHERE asignatura.id_profesor IS NULL;
SELECT DISTINCT departamento.nombre FROM departamento LEFT JOIN profesor ON departamento.id = profesor.id_departamento LEFT JOIN asignatura ON profesor.id_profesor = asignatura.id_profesor LEFT JOIN alumno_se_matricula_asignatura ON asignatura.id = alumno_se_matricula_asignatura.id_asignatura LEFT JOIN curso_escolar ON alumno_se_matricula_asignatura.id_curso_escolar = curso_escolar.id  WHERE asignatura.id_profesor IS NULL;
SELECT count(id) AS Total_Alumnes FROM persona WHERE tipo = 'alumno';
SELECT count(id) AS Total_Alumnes_nascuts_1999 FROM persona WHERE tipo = 'alumno' AND year(fecha_nacimiento) = '1999';
SELECT d.nombre, count(p.id) AS Nombre_de_profesors FROM persona p INNER JOIN profesor pr ON p.id = pr.id_profesor INNER JOIN departamento d ON pr.id_departamento = d.id WHERE p.tipo = 'profesor' GROUP BY d.nombre ORDER BY Nombre_de_profesors DESC;
SELECT d.nombre, count(p.id) AS Nombre_de_profesors FROM departamento d LEFT JOIN profesor pr ON d.id = pr.id_departamento LEFT JOIN persona p ON p.id = pr.id_profesor WHERE (p.nombre IS NULL) OR (p.tipo = 'profesor') GROUP BY d.nombre ORDER BY Nombre_de_profesors DESC;
SELECT g.nombre, count(a.id) AS Nombre_d_assignatures_associades FROM grado g LEFT JOIN asignatura a ON g.id = a.id_grado GROUP BY g.nombre ORDER BY Nombre_d_assignatures_associades DESC;
SELECT SubConsulta.nombre , SubConsulta.Nombre_d_assignatures_associades FROM (SELECT g.nombre, count(a.id) AS Nombre_d_assignatures_associades FROM grado g LEFT JOIN asignatura a ON g.id = a.id_grado GROUP BY g.nombre ORDER BY Nombre_d_assignatures_associades DESC ) AS SubConsulta WHERE Nombre_d_assignatures_associades > 40;
SELECT g.nombre, a.tipo, SUM(creditos) AS Total_Credits FROM asignatura a INNER JOIN grado g ON a.id_grado = g.id GROUP BY a.tipo, a.id_grado;
SELECT c.anyo_inicio, COUNT(a.id_alumno) AS Alumnes_matriculats FROM alumno_se_matricula_asignatura a INNER JOIN curso_escolar c ON a.id_curso_escolar = c.id GROUP BY id_curso_escolar;
SELECT pr.id_profesor, p.nombre, p.apellido1, p.apellido2, count(a.id) AS Nombre_Asignatures FROM profesor pr LEFT JOIN asignatura a ON pr.id_profesor = a.id_profesor INNER JOIN persona p ON pr.id_profesor = p.id GROUP BY pr.id_profesor ORDER BY Nombre_Asignatures DESC;
SELECT * from persona WHERE fecha_nacimiento = (SELECT  MAX(fecha_nacimiento) FROM persona WHERE tipo = 'alumno');
SELECT p.apellido1, p.apellido2, p.nombre FROM persona p LEFT JOIN profesor pr ON p.id = pr.id_profesor LEFT JOIN asignatura a ON pr.id_profesor = a.id_profesor WHERE p.tipo ='profesor'  AND a.id_profesor IS NULL;